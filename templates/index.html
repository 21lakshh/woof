<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Woof üêæ - Stray Dog Rescue</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23395a7f'/%3E%3Cpath d='M30 40c0 0 5-10 20-10s20 10 20 10M30 60c0 0 5 10 20 10s20-10 20-10M50 40v20' stroke='white' stroke-width='8' fill='none'/%3E%3C/svg%3E">
    <link rel = "stylesheet" href = "static/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Add this line to include Marked.js -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://kit.fontawesome.com/your-real-kit-code.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css"/>
</head>
<body>
    <header class="header bg-[#2d3630] p-4 flex justify-between items-center">
        <div class="logo text-purple-400 text-4xl font-extrabold">Woofüêæ</div>
        <nav class="nav-links flex space-x-6 text-lg">
            <a href="#report" class="text-white hover:text-purple-400">Report</a>
            <a href="/static/adoption_new.html" class="text-white hover:text-purple-400">Adopt</a>
            <a href="#hotspots" class="text-white hover:text-purple-400">Hotspots</a>
            <a href="#about" class="text-white hover:text-purple-400">Donate</a>
            <a href="#testimonials" class="text-white hover:text-purple-400">Testimonials</a>
        </nav>
    </header>

    <section class="hero bg-[#2d3630]">
        <div class="hero-content">
            <h1 class="hero-title text-white" style="font-size: 4rem; margin-bottom: 1rem;">Save a Life Today</h1>
            <p class="hero-subtitle text-gray-300" style="font-size: 1.5rem;">Your Report Can Make a Difference</p>
            <div class="stats-grid">
                <div class="stat-card animate delay-1 bg-[#3d463f]/50">
                    <i class="fas fa-paw text-purple-400"></i>
                    <h3 class="text-white">12,543+</h3>
                    <p class="text-gray-300">Dogs Rescued</p>
                </div>
                <div class="stat-card animate delay-2 bg-[#3d463f]/50">
                    <i class="fas fa-home text-purple-400"></i>
                    <h3 class="text-white">8,921+</h3>
                    <p class="text-gray-300">Successful Adoptions</p>
                </div>
                <div class="stat-card animate delay-3 bg-[#3d463f]/50">
                    <i class="fas fa-map-marker-alt text-purple-400"></i>
                    <h3 class="text-white">74</h3>
                    <p class="text-gray-300">Cities Covered</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Report Section -->
    <div class="w-full bg-[#2d3630] py-16" id="report">
        <div class="max-w-6xl mx-auto px-4">
            <h2 class="text-3xl md:text-4xl font-bold text-white mb-8 text-center">üêæ Report a Stray Dog</h2>
            
            <!-- Main Report Container -->
            <div class="bg-[#3d463f]/50 backdrop-blur-md rounded-xl shadow-lg border border-purple-400/20 overflow-hidden">
                <!-- Input Section -->
                <div class="p-6 space-y-6">
                    <!-- Location Input -->
                    <div class="flex gap-3">
                        <div class="flex-1">
                            <label class="block text-gray-300 text-sm font-medium mb-2">Location</label>
                            <div class="relative">
                                <input 
                                    id="location-input"
                                    type="text" 
                                    placeholder="Enter location or use current location"
                                    class="w-full p-4 bg-[#2d3630] rounded-xl border border-purple-400/30 focus:outline-none focus:ring-2 focus:ring-purple-400 text-gray-300"
                                    readonly
                                />
                                <button 
                                    type="button"
                                    onclick="toggleLocationInput()"
                                    class="absolute right-3 top-1/2 -translate-y-1/2 text-purple-400 hover:text-purple-300"
                                    title="Toggle manual input"
                                >
                                    <i class="fas fa-edit"></i>
                                </button>
                            </div>
                            <!-- Add a hidden input for coordinates -->
                            <input type="hidden" id="coordinates-input">
                            <!-- Location status message -->
                            <p id="location-status" class="text-sm text-purple-400 mt-2"></p>
                            <!-- Manual input instructions -->
                            <div id="manual-input-instructions" class="hidden mt-2 text-sm text-gray-300 bg-[#2d3630] p-3 rounded-lg">
                                <p class="font-medium mb-2">Tips for better location accuracy:</p>
                                <ul class="list-disc list-inside space-y-1">
                                    <li>Enable GPS on your device</li>
                                    <li>Move to an open area with clear sky view</li>
                                    <li>Wait a few seconds for GPS to stabilize</li>
                                    <li>Try refreshing the page and detecting again</li>
                                </ul>
                            </div>
                        </div>
                        <button 
                            type="button"
                            onclick="getLocation()"
                            id="detect-location"
                            class="px-4 bg-purple-500 hover:bg-purple-600 text-white rounded-xl transition-all flex items-center justify-center group"
                            title="Use current location"
                        >
                            <i id="location-icon" class="fas fa-location-dot text-xl group-hover:animate-pulse"></i>
                            <i id="location-loader" class="fas fa-circle-notch animate-spin text-xl hidden"></i>
                        </button>
                    </div>

                    <!-- Upload Image Section -->
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Photos</label>
                        <div class="flex items-center gap-4">
                            <button id="upload-btn" 
                                class="flex-1 py-4 px-6 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-medium rounded-xl transition-all flex items-center justify-center gap-3 shadow-lg">
                                <i class="fas fa-camera text-xl"></i>
                                <span>Upload Photo</span>
                            </button>
                            <input type="file" id="image-upload" accept="image/*" class="hidden" />
                        </div>
                        
                        <!-- Single Image Preview -->
                        <div id="image-container" class="hidden mt-4">
                            <div class="relative w-48 h-48 border-2 border-dashed border-purple-400/30 rounded-lg overflow-hidden">
                                <img id="image-preview" class="w-full h-full object-cover" />
                                <button id="remove-image" class="absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 hover:bg-red-600">
                                    <i class="fas fa-times text-xs w-4 h-4 flex items-center justify-center"></i>
                                </button>
                            </div>
                            <p class="text-sm text-gray-400 mt-2">Max 1 photo (2MB max)</p>
                        </div>
                    </div>

                    <!-- Condition -->
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Condition</label>
                        <select class="w-full p-4 bg-[#2d3630] rounded-xl border border-purple-400/30 focus:outline-none focus:ring-2 focus:ring-purple-400 text-gray-300">
                            <option value="">Select condition</option>
                            <option value="healthy">Healthy</option>
                            <option value="aggressive">Aggressive</option>
                            <option value="injured">Injured</option>
                            <option value="critical">Critical</option>
                        </select>
                    </div>

                    <!-- Description Input -->
                    <div>
                        <label class="block text-gray-300 text-sm font-medium mb-2">Additional Details</label>
                        <textarea 
                            id="query-input" 
                            rows="4" 
                            placeholder="Describe the situation, animal's behavior, or any other relevant details..."
                            class="w-full p-4 bg-[#2d3630] rounded-xl border border-purple-400/30 focus:outline-none focus:ring-2 focus:ring-purple-400 text-gray-300 resize-none"
                        ></textarea>
                    </div>

                    <!-- Submit Button -->
                    <button 
                        id="submit-query" 
                        class="w-full py-4 bg-gradient-to-r from-purple-500 to-purple-600 hover:from-purple-600 hover:to-purple-700 text-white font-medium rounded-xl transition-all flex items-center justify-center gap-3 shadow-lg"
                    >
                        <i class="fas fa-paper-plane"></i>
                        <span>Submit Report</span>
                    </button>

                    <!-- Helper Text -->
                    <div class="flex items-start gap-3 p-4 bg-purple-400/10 rounded-xl">
                        <i class="fas fa-info-circle text-purple-400 mt-1"></i>
                        <p class="text-gray-300 text-sm">
                            Your report helps us locate and rescue stray animals efficiently. We'll contact you for any additional information needed.
                        </p>
                    </div>
                </div>

                <!-- Response Section -->
                <div id="response-container" class="hidden border-t border-purple-400/20">
                    <div class="p-6 space-y-4">
                        <h3 class="text-xl font-semibold text-white flex items-center gap-2">
                            <i class="fas fa-comment-dots text-purple-400"></i>
                            Response
                        </h3>
                        <div class="bg-[#2d3630] p-4 rounded-xl text-white">
                            <!-- AI responses will appear here -->
                        </div>
                        
                        <!-- Location-specific Information -->
                        <div id="location-info" class="hidden mt-4">
                            <div class="bg-[#3d463f]/50 p-4 rounded-xl border border-purple-400/20">
                                <div class="flex items-center gap-3 mb-3">
                                    <i class="fas fa-map-marker-alt text-purple-400"></i>
                                    <h4 class="text-white font-semibold">Nearby Help</h4>
                                </div>
                                <div id="shelter-info" class="hidden">
                                    <p class="text-gray-300 mb-2">Nearest Dog Shelter:</p>
                                    <div class="bg-[#2d3630] p-3 rounded-lg">
                                        <p class="text-white font-medium">Paws & Care Shelter</p>
                                        <p class="text-gray-400 text-sm">2.5 km away</p>
                                        <p class="text-gray-400 text-sm">ETA: 15 minutes</p>
                                    </div>
                                </div>
                                <div id="vet-info" class="hidden">
                                    <p class="text-gray-300 mb-2">Nearest Veterinary Hospital:</p>
                                    <div class="bg-[#2d3630] p-3 rounded-lg">
                                        <p class="text-white font-medium">PetCare Emergency Hospital</p>
                                        <p class="text-gray-400 text-sm">1.8 km away</p>
                                        <p class="text-gray-400 text-sm">ETA: 10 minutes</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Error Message -->
                <div id="error-container" class="hidden">
                    <div class="p-6 bg-red-500/10 border-t border-red-500/20">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-circle text-red-400 mt-1"></i>
                            <p id="error-text" class="text-red-400"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <section class="features bg-[#2d3630] py-16" id="hotspots">
        <div class="max-w-6xl mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">Real-time Stray Tracking</h2>
                <p class="text-purple-400 text-lg">Monitor and help strays in your area</p>
            </div>

            <div class="grid lg:grid-cols-3 gap-8">
                <!-- Map Container -->
                <div class="lg:col-span-2 bg-[#3d463f]/50 rounded-xl shadow-lg overflow-hidden border border-purple-400/20">
                    <div class="p-4 bg-[#2d3630] text-white flex justify-between items-center">
                        <h3 class="font-semibold flex items-center gap-2">
                            <i class="fas fa-map-marker-alt text-purple-400"></i>
                            Live Hotspot Map
                        </h3>
                        <div class="flex items-center gap-4">
                            <span class="text-sm flex items-center gap-2">
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                Live Updates
                            </span>
                            <button class="p-2 hover:bg-purple-500 rounded-lg transition-colors">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    <div class="relative h-[600px]">
                        <iframe 
                            src="/static/hotspot_map.html"
                            class="absolute inset-0 w-full h-full border-none"
                            allowfullscreen>
                        </iframe>
                    </div>
                </div>

                <!-- Stats and Filters Panel -->
                <div class="space-y-6">
                    <!-- Quick Stats -->
                    <div class="bg-[#3d463f]/50 rounded-xl p-6 border border-purple-400/20">
                        <h3 class="text-white font-semibold mb-4">Current Statistics</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-3 bg-[#2d3630] rounded-lg">
                                <span class="text-gray-300">Active Reports</span>
                                <span class="text-purple-400 font-bold">24</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-[#2d3630] rounded-lg">
                                <span class="text-gray-300">Teams Deployed</span>
                                <span class="text-purple-400 font-bold">8</span>
                            </div>
                            <div class="flex justify-between items-center p-3 bg-[#2d3630] rounded-lg">
                                <span class="text-gray-300">Response Time</span>
                                <span class="text-purple-400 font-bold">~15 mins</span>
                            </div>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="bg-[#3d463f]/50 rounded-xl p-6 border border-purple-400/20">
                        <h3 class="text-white font-semibold mb-4">Map Filters</h3>
                        <div class="space-y-3">
                            <label class="flex items-center gap-2 text-gray-300">
                                <input type="checkbox" checked class="form-checkbox text-purple-400">
                                Recent Reports
                            </label>
                            <label class="flex items-center gap-2 text-gray-300">
                                <input type="checkbox" checked class="form-checkbox text-purple-400">
                                Active Teams
                            </label>
                            <label class="flex items-center gap-2 text-gray-300">
                                <input type="checkbox" checked class="form-checkbox text-purple-400">
                                High Priority Areas
                            </label>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-[#3d463f]/50 rounded-xl p-6 border border-purple-400/20">
                        <h3 class="text-white font-semibold mb-4">Recent Activity</h3>
                        <div class="space-y-4">
                            <div class="flex items-start gap-3">
                                <div class="w-2 h-2 bg-green-400 rounded-full mt-2"></div>
                                <div>
                                    <p class="text-gray-300">New report at Koramangala</p>
                                    <p class="text-gray-400 text-sm">2 minutes ago</p>
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <div class="w-2 h-2 bg-yellow-400 rounded-full mt-2"></div>
                                <div>
                                    <p class="text-gray-300">Team dispatched to Indiranagar</p>
                                    <p class="text-gray-400 text-sm">5 minutes ago</p>
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <div class="w-2 h-2 bg-blue-400 rounded-full mt-2"></div>
                                <div>
                                    <p class="text-gray-300">Rescue completed in HSR Layout</p>
                                    <p class="text-gray-400 text-sm">15 minutes ago</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="about-donation bg-[#2d3630] py-20" id="about">
        <div class="container mx-auto px-4 max-w-6xl">
            <!-- Emotional Header -->
            <div class="text-center mb-16 animate fade-in">
                <h2 class="text-4xl md:text-5xl font-bold text-white mb-6">Every Paw Deserves a Chance üêæ</h2>
                <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                    Right now, a scared puppy is searching for food. A injured dog is crying in pain. 
                    A mother cat is struggling to feed her kittens. Your help can change their story.
                </p>
            </div>

            <div class="grid md:grid-cols-2 gap-12">
                <!-- Left Side: Emotional Stories -->
                <div class="space-y-8">
                    <!-- Emergency Alert -->
                    <div class="bg-[#3d463f]/50 border border-red-500/20 rounded-xl p-6 animate pulse">
                        <div class="flex items-center gap-4 mb-4">
                            <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                            <h3 class="text-red-400 font-semibold">URGENT: 47 Rescues Waiting</h3>
                        </div>
                        <p class="text-gray-300">
                            We have 47 injured strays needing immediate medical care. Every minute counts. 
                            Your donation today can save a life tomorrow.
                        </p>
                    </div>
                    <!-- Success Story -->
                    <div class="bg-[#3d463f]/50 rounded-xl overflow-hidden">
                        <img src="static/images/VIER PFOTEN_2023-10-19_00151-2850x1900-2746x1900-1920x1328.jpg" alt="Luna's transformation" class="w-full h-64 object-cover">
                        <div class="p-6">
                            <h3 class="text-2xl font-semibold text-purple-400 mb-4">Luna's Second Chance</h3>
                            <p class="text-gray-300 mb-4">
                                "When we found Luna, she was skin and bones, too weak to even stand. 
                                Three months of love and care transformed her into the happy, healthy dog 
                                you see today. Your donation made this possible."
                            </p>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="text-center">
                                    <p class="text-sm text-gray-400">Before</p>
                                    <p class="text-2xl font-bold text-red-400">4.2 kg</p>
                                </div>
                                <div class="text-center">
                                    <p class="text-sm text-gray-400">After</p>
                                    <p class="text-2xl font-bold text-green-400">12.5 kg</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Impact Numbers -->
                    <div class="bg-[#3d463f]/50 rounded-xl p-4">
                        <div class="grid grid-cols-3 gap-4">
                            <div class="bg-white/5 rounded-xl p-4 text-center">
                                <h4 class="text-3xl font-bold text-blue-400">12,547</h4>
                                <p class="text-sm text-gray-400">Lives Saved</p>
                            </div>
                            <div class="bg-white/5 rounded-xl p-4 text-center">
                                <h4 class="text-3xl font-bold text-green-400">8,921</h4>
                                <p class="text-sm text-gray-400">Adoptions</p>
                            </div>
                            <div class="bg-white/5 rounded-xl p-4 text-center">
                                <h4 class="text-3xl font-bold text-yellow-400">74</h4>
                                <p class="text-sm text-gray-400">Cities</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Side: Donation Panel -->
                <div class="bg-[#3d463f]/30 backdrop-blur-lg rounded-xl p-8 border border-[#4d564f]/20">
                    <h3 class="text-2xl font-bold text-center text-white mb-6">
                        Be Their Guardian Angel Today üôè
                    </h3>
                    
                    <!-- Emotional Appeal -->
                    <p class="text-gray-300 mb-8 text-center">
                        For just ‚Çπ100/day, you can feed a hungry stray, provide medical care, 
                        and give them the love they deserve. Will you help?
                    </p>

                    <!-- Custom Amount -->
                    <div class="mb-8">
                        <div class="flex items-center gap-2 mb-2">
                            <span class="text-gray-300">Donate in INR</span>
                            <span class="text-sm text-blue-400">(IndiaStack Verified)</span>
                        </div>
                        <div class="flex">
                            <span class="bg-[#3d564f] px-4 py-3 rounded-l-lg text-gray-400">‚Çπ</span>
                            <input type="number" 
                                   id="donationAmount" 
                                   placeholder="Enter amount" 
                                   class="flex-1 bg-[#3d564f] px-4 py-3 rounded-r-lg text-white focus:outline-none focus:ring-2 focus:ring-[#5d665f]">
                        </div>
                        <div id="walletStatus" class="mt-2 text-sm text-gray-400"></div>
                    </div>

                    <!-- Quick Donation Options -->
                    <div class="grid grid-cols-3 gap-4 mb-8">
                        <button onclick="setDonationAmount(100)" class="bg-[#3d564f] hover:bg-[#4d665f] text-white py-3 rounded-lg transition-all">
                            ‚Çπ100
                        </button>
                        <button onclick="setDonationAmount(500)" class="bg-[#3d564f] hover:bg-[#4d665f] text-white py-3 rounded-lg transition-all">
                            ‚Çπ500
                        </button>
                        <button onclick="setDonationAmount(1000)" class="bg-[#3d564f] hover:bg-[#4d665f] text-white py-3 rounded-lg transition-all">
                            ‚Çπ1000
                        </button>
                    </div>

                    <!-- Payment Methods -->
                    <div class="grid grid-cols-1 gap-4 mb-8">
                        <button onclick="connectWallet()" 
                                id="connectWallet"
                                class="flex items-center justify-center gap-2 bg-[#4d564f] hover:bg-[#5d665f] text-white py-3 rounded-lg">
                            <i class="fas fa-id-card"></i>
                            <span>Connect IndiaStack Wallet</span>
                        </button>
                        <button onclick="showUPIVerification()" 
                                id="upiButton"
                                class="flex items-center justify-center gap-2 bg-[#4d564f] hover:bg-[#5d665f] text-white py-3 rounded-lg">
                            <i class="fas fa-qrcode"></i>
                            <span>Secure UPI with Blockchain</span>
                        </button>
                    </div>

                    <!-- Transaction Status -->
                    <div id="txStatus" class="hidden mb-8">
                        <div class="bg-[#2d3630] p-6 rounded-lg border border-[#4d564f]/20">
                            <div class="flex items-center justify-between mb-4">
                                <h4 class="text-blue-400 font-bold text-lg">Transaction Status</h4>
                                <div class="network-badge text-xs bg-blue-900/30 text-blue-400 px-3 py-1 rounded-full">
                                    <i class="fas fa-network-wired mr-1"></i>
                                    Mumbai Polygon Testnet
                                </div>
                            </div>
                            <div class="tx-details space-y-4">
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="bg-[#3d463f]/30 p-4 rounded-lg">
                                        <div class="text-sm text-gray-400 mb-1">Amount</div>
                                        <div class="text-xl font-bold text-white">‚Çπ<span id="txAmount">100</span></div>
                                    </div>
                                    <div class="bg-[#3d463f]/30 p-4 rounded-lg">
                                        <div class="text-sm text-gray-400 mb-1">Status</div>
                                        <div class="text-xl font-bold text-green-400" id="txStatusText">Confirmed</div>
                                    </div>
                                </div>
                                <div class="bg-[#3d463f]/30 p-4 rounded-lg">
                                    <div class="text-sm text-gray-400 mb-1">Transaction ID</div>
                                    <div class="font-mono text-sm text-white break-all" id="txId">TXIN1742586125488</div>
                                </div>
                                <div class="flex items-center gap-2 text-sm text-gray-400">
                                    <i class="fas fa-clock"></i>
                                    <span id="txTimestamp">Just now</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Blockchain Transaction Record -->
                    <div class="bg-[#2d3630] p-4 rounded-lg mt-6">
                        <div class="flex items-center gap-2 text-blue-400 mb-2">
                            <i class="fas fa-link"></i>
                            <h4 class="font-bold">Live Transactions</h4>
                        </div>
                        <div id="txList" class="text-sm text-gray-400 space-y-2">
                            <!-- Dynamically populated -->
                        </div>
                    </div>

                    <!-- Fraud Prevention System -->
                    <div class="bg-[#3d463f] p-4 rounded-lg mt-6">
                        <h4 class="text-yellow-400 mb-2">AI + Blockchain Monitoring</h4>
                        <div class="text-sm text-gray-400">
                            <p class="flex items-center gap-2">
                                <i class="fas fa-shield-alt"></i>
                                Live anomaly detection:
                            </p>
                            <div id="fraudStatus" class="grid grid-cols-2 gap-4 mt-2">
                                <!-- Dynamically populated -->
                            </div>
                        </div>
                    </div>

                    <!-- Final Appeal -->
                    <p class="text-center text-sm text-gray-400 mt-6 italic">
                        "Every donation, no matter how small, is a beacon of hope for a stray in need. 
                        Your kindness today creates miracles tomorrow."
                    </p>
                </div>
            </div>
            
            <!-- Bottom Testimonials Section -->
            <div class="mt-16 mb-24" id="testimonials">
                <!-- Section Header -->
                <header class="section-header text-center mb-12">
                    <h2 class="text-3xl md:text-4xl font-bold text-purple-400">Voices of Hope</h2>
                </header>

                <!-- Owl Carousel Slider -->
                <div class="owl-carousel owl-theme testimonials-container">
                    <!-- Testimonial 1 -->
                    <div class="item testimonial-card">
                        <main class="test-card-body bg-[#3d463f]/50 backdrop-blur-md rounded-xl">
                            <div class="quote">
                                <i class="fa fa-quote-left text-purple-400"></i>
                                <h2 class="text-white">A Life Transformed</h2>
                            </div>
                            <p class="text-gray-300">
                                "I found an injured puppy on the street. One call to Woof, and within 30 minutes, 
                                they were there. Today, that puppy has a loving home. Your donations make such 
                                rescues possible."
                            </p>
                            <div class="ratings">
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                            </div>
                        </main>
                        <div class="profile mt-4">
                            <div class="profile-desc">
                                <span class="text-purple-400 font-bold">Priya Shah</span>
                                <span class="text-gray-400">Mumbai Resident</span>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonial 2 -->
                    <div class="item testimonial-card">
                        <main class="test-card-body bg-[#3d463f]/50 backdrop-blur-md rounded-xl">
                            <div class="quote">
                                <i class="fa fa-quote-left text-purple-400"></i>
                                <h2 class="text-white">Emergency Response</h2>
                            </div>
                            <p class="text-gray-300">
                                "During the floods, PawsGuard rescued over 200 stranded animals. They didn't just save 
                                lives; they gave hope when all seemed lost. Every donation counts in emergencies like these."
                            </p>
                            <div class="ratings">
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                            </div>
                        </main>
                        <div class="profile mt-4">
                            <div class="profile-desc">
                                <span class="text-purple-400 font-bold">Arjun Kumar</span>
                                <span class="text-gray-400">Rescue Volunteer</span>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonial 3 -->
                    <div class="item testimonial-card">
                        <main class="test-card-body bg-[#3d463f]/50 backdrop-blur-md rounded-xl">
                            <div class="quote">
                                <i class="fa fa-quote-left text-purple-400"></i>
                                <h2 class="text-white">Daily Miracles</h2>
                            </div>
                            <p class="text-gray-300">
                                "Every morning, I see PawsGuard volunteers feeding the strays in my area. These angels 
                                work tirelessly, rain or shine. A small monthly donation helps keep their mission alive."
                            </p>
                            <div class="ratings">
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                            </div>
                        </main>
                        <div class="profile mt-4">
                            <div class="profile-desc">
                                <span class="text-purple-400 font-bold">Sneha Patel</span>
                                <span class="text-gray-400">Regular Donor</span>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonial 4 -->
                    <div class="item testimonial-card">
                        <main class="test-card-body bg-[#3d463f]/50 backdrop-blur-md rounded-xl">
                            <div class="quote">
                                <i class="fa fa-quote-left text-purple-400"></i>
                                <h2 class="text-white">Second Chances</h2>
                            </div>
                            <p class="text-gray-300">
                                "My heart broke seeing a paralyzed dog struggling. PawsGuard provided months of 
                                treatment and physiotherapy. Today, he runs and plays like any other dog. These 
                                miracles happen because of donors like you."
                            </p>
                            <div class="ratings">
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                            </div>
                        </main>
                        <div class="profile mt-4">
                            <div class="profile-desc">
                                <span class="text-purple-400 font-bold">Dr. Rahul Verma</span>
                                <span class="text-gray-400">Veterinarian</span>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonial 5 -->
                    <div class="item testimonial-card">
                        <main class="test-card-body bg-[#3d463f]/50 backdrop-blur-md rounded-xl">
                            <div class="quote">
                                <i class="fa fa-quote-left text-purple-400"></i>
                                <h2 class="text-white">Community Impact</h2>
                            </div>
                            <p class="text-gray-300">
                                "As a school teacher, I've seen how PawsGuard's work teaches children compassion. 
                                They rescued an injured puppy from our school grounds, and now our students understand 
                                the importance of being kind to animals."
                            </p>
                            <div class="ratings">
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                            </div>
                        </main>
                        <div class="profile mt-4">
                            <div class="profile-desc">
                                <span class="text-purple-400 font-bold">Meera Krishnan</span>
                                <span class="text-gray-400">School Teacher</span>
                            </div>
                        </div>
                    </div>

                    <!-- Testimonial 6 -->
                    <div class="item testimonial-card">
                        <main class="test-card-body bg-[#3d463f]/50 backdrop-blur-md rounded-xl">
                            <div class="quote">
                                <i class="fa fa-quote-left text-purple-400"></i>
                                <h2 class="text-white">Night Heroes</h2>
                            </div>
                            <p class="text-gray-300">
                                "At 2 AM, I found a critically injured dog after an accident. One call to PawsGuard's 
                                emergency helpline, and they were there within minutes. Their 24/7 service saves 
                                countless lives. Please donate to keep this lifeline running."
                            </p>
                            <div class="ratings">
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                                <i class="fa-solid fa-heart text-red-400"></i>
                            </div>
                        </main>
                        <div class="profile mt-4">
                            <div class="profile-desc">
                                <span class="text-purple-400 font-bold">Kabir Singh</span>
                                <span class="text-gray-400">Late Night Hero</span>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- Decorative Separator -->
            <!-- <div class="separator-wrapper relative h-24">
                <div class="absolute w-full overflow-hidden" style="height: 48px;">
                    <div class="w-full h-full bg-[#2d3630] transform -skew-y-3"></div>
                </div>
                <div class="absolute bottom-0 w-full overflow-hidden" style="height: 48px;">
                    <div class="w-full h-full bg-[#1a211d] transform skew-y-3"></div>
                </div>
            </div>
        </div> -->
    </section>

    <!-- Remove any constraining containers and make footer standalone -->
    <footer class="w-full bg-[#1a211d] text-gray-300 pt-16 pb-8 relative">
        <!-- Decorative Top Border -->
        <div class="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-purple-500/50 via-purple-400 to-purple-500/50"></div>
        
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12">
                <!-- Mission Section -->
                <div class="space-y-4">
                    <h3 class="text-2xl font-bold text-purple-400 mb-6">Woof</h3>
                    <p class="text-gray-400">
                        Every tail has a story, every paw needs a guardian. 
                        Join us in creating a world where no stray goes unloved.
                    </p>
                    <div class="emergency-contact bg-[#3d463f]/50 p-4 rounded-lg mt-4">
                        <h4 class="text-red-400 font-semibold">24/7 Emergency Rescue</h4>
                        <p class="text-xl font-bold text-white">1800-PAWHELP</p>
                    </div>
                </div>
                

                <!-- Quick Links -->
                <div class="space-y-4">
                    <h3 class="text-xl font-semibold text-purple-400 mb-6">Quick Links</h3>
                    <ul class="space-y-3">
                        <li>
                            <a href="#about" class="hover:text-purple-400 transition-colors flex items-center gap-2">
                                <i class="fas fa-paw"></i> About Us
                            </a>
                        </li>
                        <li>
                            <a href="#volunteer" class="hover:text-purple-400 transition-colors flex items-center gap-2">
                                <i class="fas fa-hands-helping"></i> Volunteer
                            </a>
                        </li>
                        <li>
                            <a href="#donate" class="hover:text-purple-400 transition-colors flex items-center gap-2">
                                <i class="fas fa-heart"></i> Donate
                            </a>
                        </li>
                        <li>
                            <a href="#success-stories" class="hover:text-purple-400 transition-colors flex items-center gap-2">
                                <i class="fas fa-star"></i> Success Stories
                            </a>
                        </li>
                        <li>
                            <a href="#contact" class="hover:text-purple-400 transition-colors flex items-center gap-2">
                                <i class="fas fa-phone"></i> Contact
                            </a>
                        </li>
                    </ul>
                </div>

                <!-- Locations -->
                <div class="space-y-4">
                    <h3 class="text-xl font-semibold text-purple-400 mb-6">Our Centers</h3>
                    <div class="space-y-4">
                        <div class="bg-[#3d463f]/50 p-4 rounded-lg">
                            <h4 class="font-semibold text-white">Mumbai HQ</h4>
                            <p class="text-sm text-gray-400">
                                123 Animal Care Road<br/>
                                Mumbai, MH 400001<br/>
                                <span class="text-green-400">Open 24/7</span>
                            </p>
                        </div>
                        <div class="bg-[#3d463f]/50 p-4 rounded-lg">
                            <h4 class="font-semibold text-white">Delhi Center</h4>
                            <p class="text-sm text-gray-400">
                                45 Paw Street<br/>
                                Delhi, DL 110001<br/>
                                <span class="text-green-400">Open 24/7</span>
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Connect -->
                <div class="space-y-4">
                    <h3 class="text-xl font-semibold text-purple-400 mb-6">Stay Connected</h3>
                    <!-- Newsletter -->
                    <div class="mb-6">
                        <p class="text-sm mb-3">Subscribe to our newsletter for updates</p>
                        <div class="flex">
                            <input type="email" 
                                   placeholder="Enter your email" 
                                   class="bg-[#3d463f] px-4 py-2 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-purple-400 flex-1">
                            <button class="bg-purple-500 hover:bg-purple-600 px-4 py-2 rounded-r-lg transition-colors">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                    </div>
                    <!-- Social Links -->
                    <div class="space-y-4">
                        <h4 class="font-semibold text-white">Follow Us</h4>
                        <div class="flex space-x-4">
                            <a href="#" class="bg-[#3d463f]/50 p-3 rounded-full hover:bg-purple-500 transition-colors">
                                <i class="fab fa-instagram"></i>
                            </a>
                            <a href="#" class="bg-[#3d463f]/50 p-3 rounded-full hover:bg-purple-500 transition-colors">
                                <i class="fab fa-facebook"></i>
                            </a>
                            <a href="#" class="bg-[#3d463f]/50 p-3 rounded-full hover:bg-purple-500 transition-colors">
                                <i class="fab fa-twitter"></i>
                            </a>
                            <a href="#" class="bg-[#3d463f]/50 p-3 rounded-full hover:bg-purple-500 transition-colors">
                                <i class="fab fa-youtube"></i>
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Bar -->
            <div class="mt-12 pt-8 border-t border-[#4d564f]">
                <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                    <div class="text-sm text-gray-400">
                        ¬© 2024 Woof. All rights reserved. Made with <i class="fas fa-heart text-red-400"></i> for animals
                    </div>
                    <div class="flex gap-6 text-sm">
                        <a href="#privacy" class="hover:text-purple-400 transition-colors">Privacy Policy</a>
                        <a href="#terms" class="hover:text-purple-400 transition-colors">Terms of Service</a>
                        <a href="#faq" class="hover:text-purple-400 transition-colors">FAQ</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- QR Payment Modal -->
    <div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="qrModalLabel">Scan QR to Pay</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="qr-code">
                        <img id="dynamicQRCode" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='200' height='200' viewBox='0 0 200 200'%3E%3Crect width='200' height='200' fill='%23f3f4f6'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='14' fill='%236b7280'%3EQR Code not available%3C/text%3E%3C/svg%3E" alt="UPI QR Code">
                    </div>
                    <div class="upi-details">
                        <p class="upi-id" id="upiId">animalrescue@axis</p>
                        <p class="payment-amount">‚Çπ<span id="paymentAmount">100</span></p>
                        <p class="payment-status">
                            <i class="fas fa-spinner fa-spin"></i>
                            Waiting for payment...
                        </p>
                    </div>
                    <p class="text-muted mt-3">
                        Open your UPI app and scan the QR code to complete the payment
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script src="static/script.js"></script>
    <script type="module" src="static/payment.js"></script>
    
    <!-- Add required scripts before closing body tag -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Initialize Bootstrap modals
        document.addEventListener('DOMContentLoaded', () => {
            window.bootstrap = require('bootstrap');
        });
    </script>
    <!-- Blockchain Implementation -->
    <script>
        class MockBlockchain {
            constructor() {
                this.transactions = [];
                this.wallets = new Map();
                this.loadFromStorage();
            }

            loadFromStorage() {
                const savedData = localStorage.getItem('mockBlockchain');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    this.transactions = data.transactions || [];
                    this.wallets = new Map(Object.entries(data.wallets || {}));
                }
            }

            saveToStorage() {
                const data = {
                    transactions: this.transactions,
                    wallets: Object.fromEntries(this.wallets)
                };
                localStorage.setItem('mockBlockchain', JSON.stringify(data));
            }

            connectWallet() {
                const walletAddress = `inr:0xIND${Math.random().toString(36).substr(2, 10)}`;
                this.wallets.set(walletAddress, {
                    balance: Math.floor(Math.random() * 10000),
                    currency: 'INR',
                    lastUpdated: new Date().toISOString()
                });
                this.saveToStorage();
                return walletAddress;
            }

            makeTransaction(amount, purpose) {
                const tx = {
                    id: `TXIN${Date.now()}`,
                    amount: amount,
                    currency: 'INR',
                    purpose: purpose,
                    timestamp: new Date().toISOString(),
                    status: 'pending',
                    block: Math.floor(Math.random() * 1000000),
                    hash: `0x${Math.random().toString(16).substr(2, 10)}`,
                    network: 'Mumbai Polygon Testnet'
                };
                
                setTimeout(() => {
                    tx.status = 'confirmed';
                    this.transactions.push(tx);
                    this.saveToStorage();
                }, 2000);
                
                return tx;
            }

            getTransactionHistory() {
                return this.transactions.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            }
        }

        const blockchain = new MockBlockchain();
    </script>

    <!-- Payment Handling Script -->
    <script>
        let currentWallet = null;
        let currentAmount = 0;

        function generateQRCode(amount) {
            const upiId = "animalrescue@axis";
            const recipientName = "Woof";
            const currency = "INR";

            // Construct the UPI payment URL
            const upiUrl = `upi://pay?pa=${upiId}&pn=${encodeURIComponent(recipientName)}&am=${amount}&cu=${currency}`;

            // Generate QR code using QRServer API
            const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(upiUrl)}`;

            // Update the QR code image source
            const qrCodeImg = document.getElementById('dynamicQRCode');
            qrCodeImg.src = qrCodeUrl;
        }

        function setDonationAmount(amount) {
            currentAmount = amount;
            document.getElementById('donationAmount').value = amount;
            document.getElementById('paymentAmount').textContent = amount;
            generateQRCode(amount); // Generate QR code when amount is set
        }

        async function connectWallet() {
            try {
                const walletAddress = blockchain.connectWallet();
                currentWallet = walletAddress;
                updateWalletDisplay(walletAddress);
                
                const connectButton = document.getElementById('connectWallet');
                connectButton.innerHTML = `<i class="fas fa-check"></i> <span>Connected</span>`;
                connectButton.classList.add('bg-green-600', 'hover:bg-green-700');
                
                document.getElementById('walletStatus').innerHTML = 
                    `<i class="fas fa-check-circle text-green-400"></i> Wallet Connected`;
            } catch (error) {
                alert('Failed to connect wallet. Please try again.');
            }
        }

        function updateWalletDisplay(address) {
            const shortAddress = `${address.slice(0, 6)}...${address.slice(-4)}`;
            document.getElementById('walletStatus').innerHTML = 
                `<i class="fas fa-wallet"></i> ${shortAddress}`;
        }

        function showUPIVerification() {
            if (!currentAmount) {
                alert('Please select or enter a donation amount first.');
                return;
            }

            // Generate QR code with current amount
            generateQRCode(currentAmount);

            const txStatus = document.getElementById('txStatus');
            txStatus.classList.remove('hidden');
            
            const tx = blockchain.makeTransaction(currentAmount, 'Donation');
            
            // Update transaction details with new structure
            document.getElementById('txAmount').textContent = currentAmount;
            document.getElementById('txStatusText').textContent = 'Pending';
            document.getElementById('txStatusText').classList.remove('text-green-400');
            document.getElementById('txStatusText').classList.add('text-yellow-400');
            document.getElementById('txId').textContent = tx.id;
            document.getElementById('txTimestamp').textContent = new Date().toLocaleString();

            updateTransactionList();

            const modal = new bootstrap.Modal(document.getElementById('qrModal'));
            modal.show();

            setTimeout(() => {
                document.getElementById('txStatusText').textContent = 'Confirmed';
                document.getElementById('txStatusText').classList.remove('text-yellow-400');
                document.getElementById('txStatusText').classList.add('text-green-400');
                updateTransactionList();
                modal.hide();
            }, 5000);
        }

        function updateTransactionList() {
            const txList = document.getElementById('txList');
            const transactions = blockchain.getTransactionHistory();
            
            txList.innerHTML = transactions.slice(0, 5).map(tx => `
                <div class="flex justify-between items-center py-2 border-b border-gray-700">
                    <div>
                        <div class="font-mono text-xs">${tx.id}</div>
                        <div class="text-xs text-gray-500">${new Date(tx.timestamp).toLocaleString()}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-green-400">‚Çπ${tx.amount}</div>
                        <div class="text-xs text-gray-500">${tx.status}</div>
                    </div>
                </div>
            `).join('');
        }

        function initFraudPrevention() {
            const fraudStatus = document.getElementById('fraudStatus');
            fraudStatus.innerHTML = `
                <div class="bg-green-900/30 p-2 rounded">
                    <div class="text-xs text-green-400">Transaction Pattern</div>
                    <div class="text-xs text-gray-400">Normal</div>
                </div>
                <div class="bg-green-900/30 p-2 rounded">
                    <div class="text-xs text-green-400">Risk Level</div>
                    <div class="text-xs text-gray-400">Low</div>
                </div>
            `;
        }

        document.addEventListener('DOMContentLoaded', () => {
            initFraudPrevention();
            updateTransactionList();
        });
    </script>

    <!-- Carousel Script -->
    <script>
        $('.testimonials-container').owlCarousel({
            loop: true,
            autoplay: true,
            autoplayTimeout: 6000,
            margin: 20,
            nav: true,
            navText: [
                "<i class='fa-solid fa-arrow-left'></i>",
                "<i class='fa-solid fa-arrow-right'></i>"
            ],
            responsive: {
                0: {
                    items: 1,
                    nav: false
                },
                768: {
                    items: 2,
                    nav: true
                }
            }
        });
    </script>

    <!-- Add these styles to your CSS -->
    <style>
        .testimonial-card {
            padding: 20px;
        }

        .test-card-body {
            padding: 20px;
            transition: all 0.3s ease;
        }

        .test-card-body:hover {
            transform: translateY(-5px);
        }

        .profile {
            display: flex;
            align-items: center;
        }

        .profile-image {
            width: 55px;
            height: 55px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 15px;
        }

        .profile-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .owl-nav button {
            background: #3d463f !important;
            width: 40px;
            height: 40px;
            border-radius: 50% !important;
            margin: 0 10px;
        }

        .owl-nav button i {
            color: #fff;
        }

        .owl-dots .owl-dot span {
            background: #4d564f !important;
        }

        .owl-dots .owl-dot.active span {
            background: purple-400 !important;
        }

        .separator-wrapper {
            margin-top: -48px;
            margin-bottom: -48px;
            z-index: 10;
        }

        .footer-wave {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            overflow: hidden;
            line-height: 0;
        }

        .footer-wave svg {
            position: relative;
            display: block;
            width: calc(100% + 1.3px);
            height: 70px;
        }
    </style>

    <script>
    let isManualInput = false;

    function toggleLocationInput() {
        const locationInput = document.getElementById('location-input');
        const instructions = document.getElementById('manual-input-instructions');
        isManualInput = !isManualInput;
        
        if (isManualInput) {
            locationInput.readOnly = false;
            locationInput.placeholder = "Enter your location manually";
            instructions.classList.remove('hidden');
        } else {
            locationInput.readOnly = true;
            locationInput.placeholder = "Enter location or use current location";
            instructions.classList.add('hidden');
        }
    }

    function getLocation() {
        const locationInput = document.getElementById('location-input');
        const coordinatesInput = document.getElementById('coordinates-input');
        const locationStatus = document.getElementById('location-status');
        const locationIcon = document.getElementById('location-icon');
        const locationLoader = document.getElementById('location-loader');

        // Show loading state
        locationIcon.classList.add('hidden');
        locationLoader.classList.remove('hidden');
        locationStatus.textContent = 'Detecting your location...';

        if ("geolocation" in navigator) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const { latitude, longitude, accuracy } = position.coords;

                    // Increased threshold to 2000m for better usability
                    // Most GPS devices have accuracy between 10-100m in good conditions
                    if (accuracy <= 2000) {
                        // Reverse Geocoding using OpenStreetMap Nominatim API
                        fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=18&addressdetails=1`)
                            .then(response => {
                                if (!response.ok) {
                                    throw new Error('Network response was not ok');
                                }
                                return response.json();
                            })
                            .then(data => {
                                const locationName = data.display_name || "Unknown location";
                                // Store formatted address
                                locationInput.value = locationName;
                                // Store coordinates
                                coordinatesInput.value = `${latitude},${longitude}`;
                                // Update status with accuracy info
                                locationStatus.textContent = `Location detected (Accuracy: ${Math.round(accuracy)}m)`;
                                locationStatus.classList.remove('text-red-500', 'text-yellow-500');
                                locationStatus.classList.add('text-green-500');
                            })
                            .catch((error) => {
                                console.error('Geocoding error:', error);
                                // Fallback to coordinates if geocoding fails
                                locationInput.value = `${latitude.toFixed(6)}, ${longitude.toFixed(6)}`;
                                coordinatesInput.value = `${latitude},${longitude}`;
                                locationStatus.textContent = 'Using coordinates (address lookup failed)';
                                locationStatus.classList.remove('text-red-500', 'text-green-500');
                                locationStatus.classList.add('text-yellow-500');
                            })
                            .finally(() => {
                                // Hide loading state
                                locationIcon.classList.remove('hidden');
                                locationLoader.classList.add('hidden');
                            });
                    } else {
                        locationStatus.textContent = `Location accuracy is low (${Math.round(accuracy)}m). Try moving to an open area or enter location manually.`;
                        locationStatus.classList.remove('text-green-500', 'text-yellow-500');
                        locationStatus.classList.add('text-red-500');
                        // Show manual input instructions
                        document.getElementById('manual-input-instructions').classList.remove('hidden');
                        // Hide loading state
                        locationIcon.classList.remove('hidden');
                        locationLoader.classList.add('hidden');
                    }
                },
                (error) => {
                    let errorMessage = 'Error detecting location: ';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = 'Location access denied. Please enable location services in your browser settings.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = 'Location information unavailable. Please check your GPS settings.';
                            break;
                        case error.TIMEOUT:
                            errorMessage = 'Location request timed out. Please try again.';
                            break;
                        default:
                            errorMessage = 'Unable to detect location. Please try again or enter location manually.';
                    }
                    locationStatus.textContent = errorMessage;
                    locationStatus.classList.remove('text-green-500', 'text-yellow-500');
                    locationStatus.classList.add('text-red-500');
                    // Show manual input instructions
                    document.getElementById('manual-input-instructions').classList.remove('hidden');
                    // Hide loading state
                    locationIcon.classList.remove('hidden');
                    locationLoader.classList.add('hidden');
                },
                {
                    enableHighAccuracy: true,
                    timeout: 15000, // Increased timeout to 15 seconds
                    maximumAge: 0
                }
            );
        } else {
            locationStatus.textContent = 'Geolocation is not supported by this browser. Please enter location manually.';
            locationStatus.classList.remove('text-green-500', 'text-yellow-500');
            locationStatus.classList.add('text-red-500');
            // Show manual input instructions
            document.getElementById('manual-input-instructions').classList.remove('hidden');
            // Hide loading state
            locationIcon.classList.remove('hidden');
            locationLoader.classList.add('hidden');
        }
    }
    </script>
</body>
</html>